<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Room Cleaning Shifts</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2em;
    }
    h1 {
      text-align: center;
    }
    .shift {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 1em;
      margin-bottom: 1em;
      background-color: #f9f9f9;
    }
    .shift h2 {
      margin-top: 0;
    }
    ul {
      padding-left: 1.2em;
    }
  </style>
</head>
<body>
  <h1>Organized Room Cleaning Shifts (4 Hours Each)</h1>
  <div id="shift-container"></div>

  <script>
    async function loadAndAssignShifts() {
      const response = await fetch('rooms-shift.csv');
      const csvText = await response.text();

      const lines = csvText.trim().split('\n');
      const rooms = lines.map(line => {
        const [name, priority, time] = line.split(',').map(s => s.trim());
        return {
          name,
          priority: parseInt(priority),
          time: parseInt(time)
        };
      }).filter(r => r.name && !isNaN(r.priority) && !isNaN(r.time));

      // Sort rooms by priority and time
      rooms.sort((a, b) => a.priority - b.priority || b.time - a.time);

      const shifts = [];
      let currentShift = [];
      let currentTime = 0;
      const MAX_SHIFT_MINUTES = 240;

      for (const room of rooms) {
        if (currentTime + room.time > MAX_SHIFT_MINUTES && currentShift.length > 0) {
          shifts.push(currentShift);
          currentShift = [];
          currentTime = 0;
        }
        currentShift.push(room);
        currentTime += room.time;
      }
      if (currentShift.length > 0) shifts.push(currentShift);

      const people = ['Garrett', 'Thomas'];
      const shiftContainer = document.getElementById('shift-container');

      shifts.forEach((shift, i) => {
        const assignedTo = people[i % people.length];
        const totalTime = shift.reduce((sum, room) => sum + room.time, 0);

        const div = document.createElement('div');
        div.className = 'shift';
        div.innerHTML = `<h2>Shift ${i + 1} - Assigned to: ${assignedTo} (Total: ${totalTime} min)</h2><ul>` +
          shift.map(room => `<li>${room.name} - Priority ${room.priority}, ${room.time} min</li>`).join('') +
          `</ul>`;
        shiftContainer.appendChild(div);
      });
    }

    loadAndAssignShifts();
  </script>
</body>
</html>
